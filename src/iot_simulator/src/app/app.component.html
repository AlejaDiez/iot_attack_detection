<app-menu-bar class="fixed left-5 top-5 z-inf" />
<div class="relative z-inf"><router-outlet /></div>
<hlm-toaster richColors theme="system" />
<app-canvas [brnCtxMenuTriggerFor]="canvasContextMenu">
    @for (node of nodes; track node) {
        <app-node
            [node]="node"
            [brnCtxMenuTriggerFor]="nodeContextMenu"
            [brnCtxMenuTriggerData]="{ $implicit: node.mac }" />
    }
    @for (connection of connections; track connection) {
        <app-connection [connection]="connection" />
    }
</app-canvas>

<ng-template #canvasContextMenu>
    <hlm-menu class="w-64">
        <hlm-menu-group>
            <button hlmMenuItem (click)="onInsertNode($event, 'router')">
                Insertar router
                <hlm-menu-shortcut>⌘⇧R</hlm-menu-shortcut>
            </button>
            <button hlmMenuItem (click)="onInsertNode($event)">
                Insertar dispositivo
                <hlm-menu-shortcut>⌘⇧D</hlm-menu-shortcut>
            </button>
        </hlm-menu-group>
    </hlm-menu>
</ng-template>

<ng-template #nodeContextMenu let-mac>
    <hlm-menu class="w-64">
        <hlm-menu-group>
            <button hlmMenuItem (click)="onNodeTraffic($event, mac)">
                Tráfico de red
            </button>
            <button hlmMenuItem (click)="onNodeConfig($event, mac)">
                Configurar
            </button>
        </hlm-menu-group>
        <hlm-menu-separator />
        <hlm-menu-group>
            <button hlmMenuItem (click)="onDeleteNode($event, mac)">
                Eliminar
            </button>
        </hlm-menu-group>
    </hlm-menu>
</ng-template>
